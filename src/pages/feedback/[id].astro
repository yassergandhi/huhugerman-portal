---
import Layout from '../../layouts/Layout.astro';
import { supabase } from '../../lib/supabase';

const { id } = Astro.params;

const { data: submission } = await supabase
  .from('submissions')
  .select('*')
  .eq('id', id)
  .single();

if (!submission) {
  throw new Error('Feedback no encontrado');
}
---

<Layout title="Tu Feedback">
  <div class="container">

    <a href="/dashboard" style="color:var(--accent-primary); font-weight:bold;">
      â† Volver al Dashboard
    </a>

    <h1 style="margin-top:1rem;">ğŸ§  Feedback del Tutor</h1>

    <div class="card" style="margin-top:1.5rem;">
      <h3>âœï¸ Tu respuesta</h3>
      <pre style="white-space: pre-wrap; opacity:0.85;">
{submission.content_text}
      </pre>
    </div>

    <div class="card" style="margin-top:1.5rem; border-left:4px solid var(--accent-primary);">
      <h3>ğŸ¤– CorrecciÃ³n y Comentarios</h3>
      <div innerHTML={submission.ai_feedback}></div>
    </div>

    <p style="margin-top:2rem; opacity:0.6; font-size:0.8rem;">
      Enviado el {new Date(submission.created_at).toLocaleString()}
    </p>

  </div>
</Layout>
